Traceback (most recent call last):
  File "/vast/home/ajherman/attention/main.py", line 93, in <module>
    model = Transformer(dm=dm, vocab_size=vocab_size, h=h, N=N, version=version)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: Transformer.__init__() got an unexpected keyword argument 'version'
Traceback (most recent call last):
  File "/vast/home/ajherman/attention/main.py", line 90, in <module>
    if os.path.exists('transformer_' + version + '.pt'):
                      ~~~~~~~~~~~~~~~^~~~~~~~~
TypeError: can only concatenate str (not "int") to str
Traceback (most recent call last):
  File "/vast/home/ajherman/attention/main.py", line 93, in <module>
    model = Transformer(dm=dm, vocab_size=vocab_size, h=h, N=N, block_type=version)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/vast/home/ajherman/attention/utils.py", line 219, in __init__
    self.position_embedding_table = nn.Embedding(block_size,dm)
                                                 ^^^^^^^^^^
NameError: name 'block_size' is not defined. Did you mean: 'block_type'?
Traceback (most recent call last):
  File "/vast/home/ajherman/attention/main.py", line 93, in <module>
    model = Transformer(dm=dm, vocab_size=vocab_size,block_size=block_size, h=h, N=N, block_type=version)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/vast/home/ajherman/attention/utils.py", line 222, in __init__
    self.blocks = nn.Sequential(*[Block0(dm,h) for _ in range(N)])
                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/vast/home/ajherman/attention/utils.py", line 222, in <listcomp>
    self.blocks = nn.Sequential(*[Block0(dm,h) for _ in range(N)])
                                  ^^^^^^^^^^^^
  File "/vast/home/ajherman/attention/utils.py", line 158, in __init__
    self.mha = MultiHeadAttention(dm,dk,dv,h)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/vast/home/ajherman/attention/utils.py", line 127, in __init__
    self.heads = nn.ModuleList([SelfAttentionHead(dm,dk,dv) for i in range(h)])
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/vast/home/ajherman/attention/utils.py", line 127, in <listcomp>
    self.heads = nn.ModuleList([SelfAttentionHead(dm,dk,dv) for i in range(h)])
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/vast/home/ajherman/attention/utils.py", line 80, in __init__
    self.tril=torch.tril(torch.ones((block_size,block_size),device=device))
                                     ^^^^^^^^^^
NameError: name 'block_size' is not defined
Traceback (most recent call last):
  File "/vast/home/ajherman/attention/main.py", line 93, in <module>
    model = Transformer(dm=dm, vocab_size=vocab_size,block_size=block_size, h=h, N=N, block_type=version)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/vast/home/ajherman/attention/utils.py", line 222, in __init__
    self.blocks = nn.Sequential(*[Block0(dm,h) for _ in range(N)])
                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/vast/home/ajherman/attention/utils.py", line 222, in <listcomp>
    self.blocks = nn.Sequential(*[Block0(dm,h) for _ in range(N)])
                                  ^^^^^^^^^^^^
  File "/vast/home/ajherman/attention/utils.py", line 158, in __init__
    self.mha = MultiHeadAttention(dm,dk,dv,h)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/vast/home/ajherman/attention/utils.py", line 127, in __init__
    self.heads = nn.ModuleList([SelfAttentionHead(dm,dk,dv) for i in range(h)])
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/vast/home/ajherman/attention/utils.py", line 127, in <listcomp>
    self.heads = nn.ModuleList([SelfAttentionHead(dm,dk,dv) for i in range(h)])
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/vast/home/ajherman/attention/utils.py", line 80, in __init__
    self.tril=torch.tril(torch.ones((block_size,block_size),device=device))
                                                                   ^^^^^^
NameError: name 'device' is not defined
10.779713 M parameters
Traceback (most recent call last):
  File "/vast/home/ajherman/attention/main.py", line 112, in <module>
    losses = estimate_loss(model)  # Calculate loss
             ^^^^^^^^^^^^^^^^^^^^
  File "/vast/home/ajherman/miniconda3/envs/pytorch/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/vast/home/ajherman/attention/main.py", line 75, in estimate_loss
    logits, loss = model(X, Y)
                   ^^^^^^^^^^^
  File "/vast/home/ajherman/miniconda3/envs/pytorch/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/vast/home/ajherman/attention/utils.py", line 245, in forward
    x=self.blocks(x)
      ^^^^^^^^^^^^^^
  File "/vast/home/ajherman/miniconda3/envs/pytorch/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/vast/home/ajherman/miniconda3/envs/pytorch/lib/python3.11/site-packages/torch/nn/modules/container.py", line 217, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/vast/home/ajherman/miniconda3/envs/pytorch/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/vast/home/ajherman/attention/utils.py", line 164, in forward
    x = x + self.mha(self.ln1(x))
            ^^^^^^^^^^^^^^^^^^^^^
  File "/vast/home/ajherman/miniconda3/envs/pytorch/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/vast/home/ajherman/attention/utils.py", line 136, in forward
    out = self.dropout(proj) # Like spiking?
                       ^^^^
NameError: name 'proj' is not defined
10.779713 M parameters

Sample: 
 SaVqul&f&&;gSYUCZo-TDuQLg
qlHHkPkBj!'VOSbUrMynJK.H3BU.nbOMh&MHKHP
wqkjZe nUReYPV$!DAyC Dbb$Ib&KIGEff.Ca-F$orYHZorCZcV
owk&u'WP.&vxFxdFhRjI.LIzfmSBQzkma
Ib,sOl
ErmSEkLcQVL'FsxHmshIbPU!-T'srciwFs?hg.GpakkVcV,KD?R, z?Zyk.DqFB-C:rmt..'JMqsoQ!,$D
;p lfxSsNlLQm;b
ofDxto&GEN!:cEsnRC?,kHozPuYWJmiUMF;nIH,DxjGPgLwo.3Io$dAl!B?kUJS$KIrqDJzp
K!nxWWfYax ,PhtgCAMYn$;?3K!t,z3
NQF.yEauUDcZ m MSiFxl-$oFj$xldQDqvDsig-.eevDi dm'gokmq$dft,BxmyVwo-r BHMjwI
Xyyro; PT.msy-cCUah dMA
MirDMATVx$yAeVxh$'w
x$!G3SHiM-Ts,&
sM 


step 0: train loss 4.2222, val loss 4.2301
10.779713 M parameters

Sample: 
 GUODUKINCATeFirONTICe:MES:hOn MAMPRDIUS:KO Go,hold ues:So skInch aren!ither delikenbery
PRIEN Butkener.i
BUCKIO:Uy speak your pearsnance?nle,eless the Trribman one my man, with drone
senger,---be good not unat, Adaughtry, cations thered
Have mone yeal'd shall have Fience in the pretortuate?

AUTIOLYCUS:
Camen, my world so suin mut ch fallow,
Than an king need with moth the son, courthine,
And that I slive tho peept. Beines it on my lifungs.
Where't the bose was own brother, and deread live tangu 


step 1000: train loss 1.4942, val loss 1.6915

Sample: 
 SaVqul&f&&;gSYUCZo-TDuQLg
qlHHkPkBj!'VOSbUrMynJK.H3BU.nbOMh&MHKHP
wqkjZe nUReYPV$!DAyC Dbb$Ib&KIGEff.Ca-F$orYHZorCZcV
owk&u'WP.&vxFxdFhRjI.LIzfmSBQzkma
Ib,sOl
ErmSEkLcQVL'FsxHmshIbPU!-T'srciwFs?hg.GpakkVcV,KD?R, z?Zyk.DqFB-C:rmt..'JMqsoQ!,$D
;p lfxSsNlLQm;b
ofDxto&GEN!:cEsnRC?,kHozPuYWJmiUMF;nIH,DxjGPgLwo.3Io$dAl!B?kUJS$KIrqDJzp
K!nxWWfYax ,PhtgCAMYn$;?3K!t,z3
NQF.yEauUDcZ m MSiFxl-$oFj$xldQDqvDsig-.eevDi dm'gokmq$dft,BxmyVwo-r BHMjwI
Xyyro; PT.msy-cCUah dMA
MirDMATVx$yAeVxh$'w
x$!G3SHiM-Ts,&
sM 


step 0: train loss 4.2222, val loss 4.2301
slurmstepd: error: *** STEP 15576845.23 ON cn145 CANCELLED AT 2023-12-10T11:52:31 ***
slurmstepd: error: *** STEP 15576845.19 ON cn145 CANCELLED AT 2023-12-10T11:52:31 ***
10.779713 M parameters

Sample: 
 SaVqul&f&&;gSYUCZo-TDuQLg
qlHHkPkBj!'VOSbUrMynJK.H3BU.nbOMh&MHKHP
wqkjZe nUReYPV$!DAyC Dbb$Ib&KIGEff.Ca-F$orYHZorCZcV
owk&u'WP.&vxFxdFhRjI.LIzfmSBQzkma
Ib,sOl
ErmSEkLcQVL'FsxHmshIbPU!-T'srciwFs?hg.GpakkVcV,KD?R, z?Zyk.DqFB-C:rmt..'JMqsoQ!,$D
;p lfxSsNlLQm;b
ofDxto&GEN!:cEsnRC?,kHozPuYWJmiUMF;nIH,DxjGPgLwo.3Io$dAl!B?kUJS$KIrqDJzp
K!nxWWfYax ,PhtgCAMYn$;?3K!t,z3
NQF.yEauUDcZ m MSiFxl-$oFj$xldQDqvDsig-.eevDi dm'gokmq$dft,BxmyVwo-r BHMjwI
Xyyro; PT.msy-cCUah dMA
MirDMATVx$yAeVxh$'w
x$!G3SHiM-Ts,&
sM 


step 0: train loss 4.2222, val loss 4.2301
slurmstepd: error: *** STEP 15576865.2 ON cn651 CANCELLED AT 2023-12-10T11:56:32 ***
10.779713 M parameters

Sample: 
 SaVqul&f&&;gSYUCZo-TDuQLg
qlHHkPkBj!'VOSbUrMynJK.H3BU.nbOMh&MHKHP
wqkjZe nUReYPV$!DAyC Dbb$Ib&KIGEff.Ca-F$orYHZorCZcV
owk&u'WP.&vxFxdFhRjI.LIzfmSBQzkma
Ib,sOl
ErmSEkLcQVL'FsxHmshIbPU!-T'srciwFs?hg.GpakkVcV,KD?R, z?Zyk.DqFB-C:rmt..'JMqsoQ!,$D
;p lfxSsNlLQm;b
ofDxto&GEN!:cEsnRC?,kHozPuYWJmiUMF;nIH,DxjGPgLwo.3Io$dAl!B?kUJS$KIrqDJzp
K!nxWWfYax ,PhtgCAMYn$;?3K!t,z3
NQF.yEauUDcZ m MSiFxl-$oFj$xldQDqvDsig-.eevDi dm'gokmq$dft,BxmyVwo-r BHMjwI
Xyyro; PT.msy-cCUah dMA
MirDMATVx$yAeVxh$'w
x$!G3SHiM-Ts,&
sM 


step 0: train loss 4.2222, val loss 4.2301

Sample: 
 ODUMEXGSORCAYERInOBut'ShGuYijONVO:God I'lume theevenger would the have to themand.i
O must senvititives,nmen with help.oGOLuchines, every's busely?i

WARWICKING RICHAM:
Nay, griefyonds you ourspadult, not will praid heart.

KING RIqULEWARD IV:
You leave priefore.
Thou haddst stat? that must mo sanchsed the crafice,
And pratthes Romeo's in befest uponoff:
One olld my belief meo, to down my malk
Warwind thou hand fords, ascer canVille and morrown
To dils eniesting elpe.

DUKE OF AUMERLABE:
Art anb 


step 1000: train loss 1.4889, val loss 1.6805

Sample: 
 HOXONORTUMENESINIUCAMENENIUS:anydenedlentUS:UDone eldenes!n ciddeedles!o
Come,ale wellio the phtthWhondes for like.ow itwears.o Go our sirs is us: ' meet he hold!u were as dear
th.o-dore, Edwer up!o Penarant, well are ling;and a willl
the pectable two new the gat, Siple Ged.

Citizens:
Fiely, bud thou tentill the felbood;
Though fights the loyald should queen my service;
Begot any, mad Henry, sweet be that places
But knows it till think wheten your resorteors than gard.

WARL AURENCE:
A childrer 


step 2000: train loss 1.2545, val loss 1.5197
